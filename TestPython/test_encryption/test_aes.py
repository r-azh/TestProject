import base64
from Crypto.Cipher import AES
from Crypto import Random

BS = 16
pad = lambda s: s + (BS - len(s) % BS) * chr(BS - len(s) % BS)
unpad = lambda s: s[:-ord(s[len(s)-1:])]


class AESCipher:
    def __init__(self, key):
        self.key = key

    def encrypt(self, raw):
        raw = pad(raw)
        iv = Random.new().read(AES.block_size)
        cipher = AES.new(self.key, AES.MODE_CBC, iv) #Mode_CFB
        return base64.b64encode(iv + cipher.encrypt(raw))

    def decrypt(self, enc):
        enc = base64.b64decode(enc)
        iv = enc[:16]
        cipher = AES.new(self.key, AES.MODE_CBC, iv)
        return unpad(cipher.decrypt(enc[16:]))


bytes_ =[
    'test',
    b'\n=\x08\x82\x83\x80\xb0\xf2\xda\xe6\xffX\x12\x19\n\ninbox_name\x12\x0bheavy_inbox\x1a\x0c\x08\x82\x97\x80\xd0\xe3\xea\xf9\x96Z\x10\x01"\x02{}(\xa1\xee\xdf\xe2\x05',
    b'\n=\x08\x82\x83\x80\xb0\xf2\xda\xe6\xffX\x12\x19\n\ninbox_name\x12\x0bheavy_inbox\x1a\x0c\x08\x82\x97\x80\xf0\xef\x97\xfb\x96Z\x10\x01"\x02{}(\xab\xf9\xdf\xe2\x05',
    b'\n=\x08\x82\x83\x80\xb0\xf2\xda\xe6\xffX\x12\x19\n\ninbox_name\x12\x0bheavy_inbox\x1a\x0c\x08\x82\x97\x80\xa0\x92\xb1\xfb\x96Z\x10\x01"\x02{}(\xfa\xfa\xdf\xe2\x05',
    b'\n=\x08\x82\x83\x80\xb0\xf2\xda\xe6\xffX\x12\x19\n\ninbox_name\x12\x0bheavy_inbox\x1a\x0c\x08\x82\x97\x80\xe0\x9a\xc3\xfb\x96Z\x10\x01"\x02{}(\x8e\xfc\xdf\xe2\x05',
    b'\x08\xc2\x97\x80\x80\xa0\x9f\xfc\x96Z\x10\x01(\x018\x01@\x82\x97\x80\x80\xa0\x9f\xfc\x96ZH\x01P\xb5\xfe\xfe\xe3\x05Z\x17\n\x15\n\x0c\xd8\xa7\xd8\xb5\xd9\x81\xd9\x87\xd8\xa7\xd9\x86\x12\x05exact',
    b'\x08\xc2\x99\x80\x80\x8b\xa6\xfc\x96Z\x10\x01(\x018\x01@\x82\x99\x80\x80\x8b\xa6\xfc\x96ZH\x01P\xe9\xfe\xfe\xe3\x05Z\x17\n\x15\n\x0c\xd8\xa7\xd8\xb5\xd9\x81\xd9\x87\xd8\xa7\xd9\x86\x12\x05exact',
    # '<!DOCTYPE html PUBLIC -//W3C//DTD  1.0 Strict//EN http://www.w3.org/TR/xhtml1-strict.dtd><html xmlns=http://www.w3.org/1999/xhtml"><head><meta htquiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width" /><title>محتوای اینباکس "{{inbox_name}}" با موفقیت جمع\u200cآوری شد</title><link href="https://fonts.googleapis.com/earlyaccess/notonaskharabic.css" rel="stylesheet"><style type="text/css">/*////// RESET STYLES //////*/body {height: 100% !important;margin: 0;padding: 0;width: 100% !important;}table {border-collapse: separate;}img,a img {border: 0;outline: none;text-decoration: none;}h1,h2,h3,h4,h5,h6 {margin: 0;padding: 0;}p {margin: 1em 0;}/*////// CLIENT-SPECIFIC STYLES //////*/.ReadMsgBody {width: 100%;}.ExternalClass {width: 100%;}.ExternalClass,.ExternalClass p,.ExternalClass span,.ExternalClass font,.ExternalClass td,.ExternalClass div {line-height: 100%;}table,td {mso-table-lspace: 0pt;mso-table-rspace: 0pt;}#outlook a {padding: 0;}img {-ms-interpolation-mode: bicubic;}body,table,td,p,a,li,blockquote {-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;}/*////// GENERAL STYLES //////*/img {max-width: 100%;height: auto;}/*////// TABLET STYLES //////*/@media only screen and (max-width: 620px) {.shrink_font {font-size: 62px;}/*////// GENERAL STYLES //////*/#foxeslab-email .table1 {width: 90% !important;}#foxeslab-email .table1-2 {width: 98% !important;margin-left: 1%;margin-right: 1%;}#foxeslab-email .table1-3 {width: 98% !important;margin-left: 1%;margin-right: 1%;}#foxeslab-email .table1-4 {width: 98% !important;margin-left: 1%;margin-right: 1%;}#foxeslab-email .table1-5 {width: 90% !important;margin-left: 5%;margin-right: 5%;}#foxeslab-email .tablet_no_float {clear: both;width: 100% !important;margin: 0 auto !important;text-align: center !important;}#foxeslab-email .tablet_wise_float {clear: both;float: none !important;width: auto !important;margin: 0 auto !important;text-align: center !important;}#foxeslab-email .tablet_hide {display: none !important;}#foxeslab-email .image1 {width: 98% !important;}#foxeslab-email .image1-290 {width: 100% !important;max-width: 290px !important;}.center_content {text-align: center !important;}.center_image {margin: 0 auto !important;}.center_button {width: 50% !important;margin-left: 25% !important;max-width: 250px !important;}.centerize {margin: 0 auto !important;}}/*////// MOBILE STYLES //////*/@media only screen and (max-width: 480px) {.shrink_font {font-size: 48px;}.safe_color {color: #6a1b9a !important;}/*////// CLIENT-SPECIFIC STYLES //////*/body {width: 100% !important;min-width: 100% !important;}/* Force iOS Mail to render the email at full width. */table[class="flexibleContainer"] {width: 100% !important;}/* to prevent Yahoo Mail from rendering media query styles on desktop *//*////// GENERAL STYLES //////*/img[class="flexibleImage"] {height: auto !important;width: 100% !important;}#foxeslab-email .table1 {width: 98% !important;}#foxeslab-email .no_float {clear: both;width: 100% !important;margin: 0 auto !important;text-align: center !important;}#foxeslab-email .wise_float {clear: both;float: none !important;width: auto !important;margin: 0 auto !important;text-align: center !important;}#foxeslab-email .mobile_hide {display: none !important;}.auto_height {height: auto !important;}}</style></head><body style="padding: 0;margin: 0;" id="foxeslab-email"><!-- template-1 --><table class="table_full" bgcolor="#ffffff" width="100%" align="center" cellspacing="0" cellpadding="0" border="0" style="background-image: url(#); background-repeat: no-repeat; background-position: center left; background-size: 100% 100%; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt;"><!-- padding-top --><tr><td height="10"></td></tr><!-- header --><tr><td><table class="table1" width="600" align="center" border="0" cellspacing="0" cellpadding="0"><tr><td style="padding-top: 8px;padding-right: 40px;padding-bottom: 0;padding-left: 40px"><!-- Logo --><table class="no_float" align="center" border="0" cellspacing="0" cellpadding="0"><tr><td align="center"><a href="http://app.newsbx.com"><img width="200px" class="centerize" src="http://static.newsbx.com/newsbx/email/logo.png" style="display:block; line-height:0; font-size:0; border:0;" border="0" alt="image" /></a></td></tr><!-- margin-bottom --><tr><td height="8"></td></tr></table><!-- END logo --></td></tr></table></td></tr><!-- END header --><!-- horizontal gap --><tr><td height="15"></td></tr><!-- body --><tr><td><table class="table1" width="600" align="center" border="0" cellspacing="0" cellpadding="0"><tr><td bgcolor="#fcfcfc" style="padding: 40px 0;border: 1px solid #f2f2f2;border-radius: 5px;"><!-- body-container --><table class="table1" width="480" align="center" border="0" cellspacing="0" cellpadding="0"><!-- main-icon --><tr><td class="editable-img" align="center"><img src="http://static.newsbx.com/newsbx/email/inbox-initialized.png" style="display:block; line-height:0; font-size:0; border:0;" border="0" alt="image" /></td></tr><!-- END main-icon --><!-- horizontal gap --><tr><td height="15"></td></tr><!-- email details --><!-- email heading --><tr><td align="center" style="line-height: 1;color: #282828; font-size: 18px; font-weight: 600; font-family: \'IranYekan\', \'IranSans\', \'BYekan\', \'XYekan\', \'Yekan\', \'Noto Naskh Arabic\', Tahoma, sans-serif;text-align:right;direction:rtl; mso-line-height-rule: exactly;"><div class="editable-text"><h1 style="font-size:26px;" class="text_container">سلام</h1></div></td></tr><!-- END email heading --><!-- horizontal gap --><tr><td height="20"></td></tr><tr><td align="center" style="line-height: 1.8;color: #757575; font-size: 14px; font-weight: 400; font-family: \'IranYekan\', \'IranSans\', \'BYekan\', \'XYekan\', \'Yekan\', \'Noto Naskh Arabic\', Tahoma, sans-serif;text-align:right;direction:rtl; mso-line-height-rule: exactly;"><div class="editable-text"><span class="text_container">محتوای اینباکس "{{inbox_name}}" از پنل "{{username}}" با موفقیت جمع\u200cآوری شد و شما می\u200cتوانید با مراجعه به وب و یا اپلیکیشن نیوزباکس آن را مشاهده کنید.</span></div></td></tr><!-- END email details --><!-- horizontal gap --><tr><td height="25"></td></tr><!-- buttons --><tr><td align="center"><table align="center" border="0" cellspacing="0" cellspacing="0"><tr><td><table bgcolor="#282828" width="140" height="40" align="right" border="0" cellpadding="0" cellspacing="0" style="border-radius:5px; border-collapse: separate"><tr><td align="center" valign="middle" style="font-size: 14px; font-weight: 400; font-family: \'IranYekan\', \'IranSans\', \'BYekan\', \'XYekan\', \'Yekan\', \'Noto Naskh Arabic\', Tahoma, sans-serif;text-align:center;direction:rtl; mso-line-height-rule: exactly;"><div class="editable-text"><span class="text_container"><a href="{{newsbox_mobile_app_link}}" class="text_color_ffffff" style="text-decoration: none; color: #ffffff;">اپلیکیشن نیوزباکس</a></span></div></td></tr></table></td><!-- VERTICAL GAP --><td width="20"></td><td><table bgcolor="#5e35b1" width="140" height="40" align="right" border="0" ce"0" cellspacing="0" style="border-radius:5px; border-collapse: separate"><tr><td align="center" valign="middle" style="font-size: 14px; font-weight: 400; font-family: \'IranYekan\', \'IranSans\', \'BYekan\', \'XYekan\', \'Yekan\', \'Noto Naskh Arabic\', Tahoma, sans-serif;text-align:center;direction:rtl; mso-line-height-rule: exactly;"><div class="editable-text"><span class="text_container"><a href="{{newsbox_web_app_link}}" class="text_color_ffffff" style="text-decoration: none; color: #ffffff;">ورود به نیوزباکس</a></span></div></td></tr></table></td></tr></table></td></tr><!-- END buttons --><!-- horizontal gap --><tr><td height="25"></td></tr><tr><td align="center" style="line-height: 1.8;color: #757575; font-size: 14px; font-weight: 400; font-family: \'IranYekan\', \'IranSans\', \'BYekan\', \'XYekan\', \'Yekan\', \'Noto Naskh Arabic\', Tahoma, sans-serif;text-align:right;direction:rtl; mso-line-height-rule: exactly;"><div class="editable-text"><span class="text_container">چنانچه در هر مرحله از کار با نیوزباکس با مورد خاصی رو\u200cبه\u200cرو شدید، می\u200cتوانید با کارشناسان آنلاین ما مشورت کنید.</span></div></td></tr><!-- horizontal gap --><tr><td height="40"></td></tr><tr><td align="center" style="line-height: 1.8;color: #757575; font-size: 14px; font-weight: 400; font-family: \'IranYekan\', \'IranSans\', \'BYekan\', \'XYekan\', \'Yekan\', \'Noto Naskh Arabic\', Tahoma, sans-serif;text-align:right;direction:rtl; mso-line-height-rule: exactly;"><div class="editable-text"><span class="text_container">با احترام</span><br><span class="text_container">پشتیبانی مشتریان نیوزباکس</span></div></td></tr><!-- END email details --></table><!-- END body-container --></td></tr></table></td></tr><!-- END body --><!-- horizontal gap --><tr><td height="40"></td></tr><!-- footer --><tr><td><table class="table1" width="600" align="center" border="0" cellspacing="0" cellpadding="0"><tr><td align="center" style="line-height: 1;color: #757575; font-size: 14px; font-weight: 400; font-family: \'IranYekan\', \'IranSans\', \'BYekan\', \'XYekan\', \'Yekan\', \'Noto Naskh Arabic\', Tahoma, sans-serif;text-align:center;direction:rtl; mso-line-height-rule: exactly;"><div class="editable-text"><span class="text_container">&copy; تمامی حقوق برای <a href="{{pouyarasaneh_link}}" style="text-decoration:none;color:#5e35b1;">پویارسانه</a> محفوظ است.</span></div></td></tr><!-- horizontal gap --><tr><td height="15"></td></tr><tr><td align="center" style="line-height: 1;color: #c6c6c6; font-size: 14px; font-weight: 400; font-family: \'IranYekan\', \'IranSans\', \'BYekan\', \'XYekan\', \'Yekan\', \'Noto Naskh Arabic\', Tahoma, sans-serif;text-align:center;direction:rtl; mso-line-height-rule: exactly;"><!-- social icons --><table class="no_float" width="100%" align="center" border="0" cellspacing="0" cellpadding="0"><tr><td><table width="135" align="center" border="0" cellspacing="0" cellpadding="0" style="max-width: 135px;"><tr><td class="editable-img" align="center"><a href="https://www.instagram.com/newsboxdotir"><img class="centerize" src="http://static.newsbx.com/newsbx/email/twitter.png" style="display:block; line-height:0; font-size:0; border:0;;width:32px" border="0" alt="image" /></a></td><td class="editable-img" align="center"><a href="https://www.linkedin.com/showcase/newsboxdotir"><img class="centerize" src="http://static.newsbx.com/newsbx/email/linkedin.png" style="display:block; line-height:0; font-size:0; border:0;width:32px" border="0" alt="image" /></a></td><td class="editable-img" align="center"><a href="https://www.instagram.com/newsboxdotir"><img class="centerize" src="http://static.newsbx.com/newsbx/email/instagram.png" style="display:block; line-height:0; font-size:0; border:0;;width:32px" border="0" alt="image" /></a></td></tr></table></td></tr><!-- horizontal gap --><tr><td height="20"></td></tr><tr><td align="center" style="line-height: 1;color: #757575; font-size: 12px; font-weight: 400; font-family: \'IranYekan\', \'IranSans\', \'BYekan\', \'XYekan\', \'Yekan\', \'Noto Naskh Arabic\', Tahoma, sans-serif;text-align:center;direction:rtl; mso-line-height-rule: exactly;"><div class="editable-text"><span class="text_container"><a href="{{unsubscribe_link}}" style="text-decoration:none;color:#5e35b1;">لغو اشتراک</a></span></div></td></tr><!-- margin-bottom --><tr><td height="30"></td></tr></table><!-- END social icons --></td></tr></table></td></tr><!-- END footer --><!-- padding-bottom --><tr><td height="100"></td></tr></table></body></html>'
    ]

# from Crypto.Cipher import AES
# obj = AES.new('This is a key123', AES.MODE_CBC, 'This is an IV456')
#
# message = 'sample message'
#
# ciphertext = obj.encrypt(message)
#
# print(ciphertext)
print(len(bytes_[-1]) % 16)

key = 'secret_key_12345'
for item in bytes_:
    result = AESCipher(key).encrypt(str(item))
    print(len(result))
    result2 = AESCipher(key).decrypt(result)
    print(result)
    r = result2.decode().lstrip('b\\')
    print(r)
    # print(result2.decode())
    print(bytes(r.encode()) == item)

